'===========================
' Funkcja: RunValidations
'===========================

' RunValidations uruchamia wszystkie kontrole jakości danych, zatrzymuje pipeline przy pierwszym błędzie i 
'  informuje log, czy dane nadają się do eksportu.

    Private Function RunValidations() As Boolean
        On Error GoTo ErrHandler
    
        LogInfo "RunValidations", "Validation started", ""
    
' Dane nie są puste
        If Not Validate_DataNotEmpty() Then
            LogError "RunValidations", "DataNotEmpty FAILED", ""
            RunValidations = False
            Exit Function
        End If
    
' Brak pustych kluczy
        If Not Validate_NoBlankKeys() Then
            LogError "RunValidations", "NoBlankKeys FAILED", ""
            RunValidations = False
            Exit Function
        End If
    
' Klucze unikalne
        If Not Validate_UniqueKeys() Then
            LogError "RunValidations", "UniqueKeys FAILED", ""
            RunValidations = False
            Exit Function
        End If
    
' Poprawne typy danych
        If Not Validate_DataTypes() Then
            LogError "RunValidations", "DataTypes FAILED", ""
            RunValidations = False
            Exit Function
        End If
    
' Zakresy wartości
        If Not Validate_Ranges() Then
            LogError "RunValidations", "Ranges FAILED", ""
            RunValidations = False
            Exit Function
        End If
    
' Brak błędów Excelowych
        If Not Validate_NoErrors() Then
            LogError "RunValidations", "NoErrors FAILED", ""
            RunValidations = False
            Exit Function
        End If
    
        LogInfo "RunValidations", "All validations PASSED", ""
        RunValidations = True
        Exit Function
    
    ErrHandler:
        LogError "RunValidations", "Unhandled validation error", _
                 "Err " & Err.Number & ": " & Err.Description
        RunValidations = False
    End Function



