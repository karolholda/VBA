'===========================
' Funkcja: Validate_UniqueKeys
'===========================
' Sprawdza, czy w kolumnie kluczy nie występują duplikaty

    Private Function Validate_UniqueKeys() As Boolean

        Dim ws As Worksheet
        Dim lastRow As Long
        Dim rng As Range
        Dim c As Range
    
        Set ws = ThisWorkbook.Worksheets(DATA_SHEET)
    
' Ostatni wiersz danych w kolumnie klucza
        lastRow = ws.Cells(ws.Rows.Count, KEY_COL).End(xlUp).Row
    
' Jeśli brak danych (tylko nagłówek)
        If lastRow <= HEADER_ROW Then
            Validate_UniqueKeys = False
            Exit Function
        End If
    
' Zakres kluczy (bez nagłówka)
        Set rng = ws.Range(KEY_COL & (HEADER_ROW + 1) & ":" & KEY_COL & lastRow)
    
' Sprawdź, czy którykolwiek klucz występuje więcej niż raz
        For Each c In rng.Cells
            If Application.WorksheetFunction.CountIf(rng, c.Value) > 1 Then
                Validate_UniqueKeys = False
                Exit Function
            End If
        Next c
    
        Validate_UniqueKeys = True
    End Function

