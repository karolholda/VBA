'===========================
' Funkcja: UniqueKeys
'===========================

' Sprawdza, czy w kolumnie kluczy nie występują duplikaty i chroni pipeline przed błędnymi, zdublowanymi rekordami.

    Private Function Validate_UniqueKeys() As Boolean
        Dim ws As Worksheet
        Dim lastRow As Long
        Dim rng As Range
    
        Set ws = Sheets("Data")
    
' Znajdź ostatni wiersz z danymi w kolumnie A
        lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
' Jeśli brak danych (tylko nagłówek) → FAIL
        If lastRow < 2 Then
            Validate_UniqueKeys = False
            Exit Function
        End If
    
' Zakres kluczy (bez nagłówka)
        Set rng = ws.Range("A2:A" & lastRow)
    
' Sprawdzenie unikalności, duplikatów:
'   liczba niepustych = liczba unikalnych ?
        Validate_UniqueKeys = Application.WorksheetFunction.CountA(rng) = Application.WorksheetFunction.CountIf(rng, "<>")
    
    End Function
