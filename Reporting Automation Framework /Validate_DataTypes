'===========================
' Funkcja: DataTypes
'===========================

' Sprawdza, czy dane mają oczekiwane typy

    Private Function Validate_DataTypes() As Boolean
        Dim ws As Worksheet
        Dim lastRow As Long
        Dim r As Long
    
        Set ws = ThisWorkbook.Worksheets(DATA_SHEET)
    
' Znajdź ostatni wiersz danych na podstawie kolumny klucza
        lastRow = ws.Cells(ws.Rows.Count, KEY_COL).End(xlUp).Row
    
' Brak danych (tylko nagłówek) = FAIL
        If lastRow <= HEADER_ROW Then
            Validate_DataTypes = False
            Exit Function
        End If
    
' Sprawdź typy danych w każdym wierszu (od pierwszego wiersza danych)
        For r = HEADER_ROW + 1 To lastRow
    
' KEY_COL: klucz musi być niepusty (po Trim) – zwykle traktujemy go jako tekst
            If Trim$(CStr(ws.Cells(r, KEY_COL).Value)) = "" Then
                Validate_DataTypes = False
                Exit Function
            End If
    
' DATE_COL: musi być datą
            If Not IsDate(ws.Cells(r, DATE_COL).Value) Then
                Validate_DataTypes = False
                Exit Function
            End If
    
' AMOUNT_COL: musi być liczbą
            If Not IsNumeric(ws.Cells(r, AMOUNT_COL).Value) Then
                Validate_DataTypes = False
                Exit Function
            End If
    
        Next r
    
' Jeśli wszystko OK
        Validate_DataTypes = True
    End Function
