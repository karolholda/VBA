'===========================
' Funkcja: Validate_Ranges
'===========================
' Sprawdza podstawowe założenia logiczne (ranges)

    Private Function Validate_Ranges() As Boolean
        Dim ws As Worksheet
        Dim lastRow As Long
        Dim r As Long
    
        Set ws = ThisWorkbook.Worksheets(DATA_SHEET)
    
        ' Ostatni wiersz danych
        lastRow = ws.Cells(ws.Rows.Count, KEY_COL).End(xlUp).Row
    
        ' Brak danych = FAIL
        If lastRow <= HEADER_ROW Then
            Validate_Ranges = False
            Exit Function
        End If
    
        For r = HEADER_ROW + 1 To lastRow
    
            ' Data nie może być z przyszłości (zakładamy, że DataTypes sprawdził IsDate)
            If CDate(ws.Cells(r, DATE_COL).Value) > Date Then
                Validate_Ranges = False
                Exit Function
            End If
    
            ' Kwota nie może być ujemna (zakładamy, że DataTypes sprawdził IsNumeric)
            If CDbl(ws.Cells(r, AMOUNT_COL).Value) < 0 Then
                Validate_Ranges = False
                Exit Function
            End If
    
        Next r
    
        Validate_Ranges = True
    End Function
