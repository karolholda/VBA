Sub PublishToSharePointSyncFolder(ByVal files As Variant, ByVal OutFolder As String)
    On Error GoTo EH

    Dim i As Long
    Dim src As String
    Dim dst As String

' Upewnij się, że folder docelowy kończy się "\"
    If Right(OutFolder, 1) <> "\" Then OutFolder = OutFolder & "\"

' Sprawdź czy folder docelowy istnieje
    If Dir(OutFolder, vbDirectory) = "" Then
        Err.Raise vbObjectError + 300, , _
            "Folder docelowy (SharePoint/Teams sync) nie istnieje:" & vbCrLf & OutFolder
    End If

' Skopiuj każdy plik do folderu docelowego
    For i = LBound(files) To UBound(files)

        src = CStr(files(i))

' Sprawdź czy plik źródłowy istnieje
        If Dir(src) = "" Then
            Err.Raise vbObjectError + 301, , _
                "Nie znaleziono pliku do publikacji:" & vbCrLf & src
        End If

' Zbuduj ścieżkę docelową: folder + nazwa pliku
        dst = OutFolder & Dir(src)

' Nadpisz plik jeśli już istnieje
        If Dir(dst) <> "" Then Kill dst

' Skopiuj plik
        FileCopy src, dst

    Next i

    Exit Sub

EH:
    Err.Raise vbObjectError + 302, , _
        "PublishToSharePointSyncFolder: błąd publikacji." & vbCrLf & _
        "Err " & Err.Number & ": " & Err.Description
End Sub
